{% extends 'pantry/base.html' %}
{% load staticfiles %}
{% load pantry_template_tags %}

{% block title_block %}
	Add recipe
{% endblock %}

{% block body_block %}
	<h1 class="central-heading">Add Recipe</h1>
	<br />
	{% if recipe %}
		<p class="info-message">Your recipe has been added successfully! <br /> Thank you for contributing to the Pantry!</p>
		<br />
		<form action="{% url 'pantry:show_recipe' recipe.slug %}" method="POST">
			{% csrf_token %}
			<button class="btn-continue" id="btn-redir" type="submit">View recipe</button>
		</form>
	{% elif error %}
		<p class="info-message">Something went wrong! <br /> Please go back and have another go, or try again later!</p>
		<br />
		<button class="btn-back" type="button" onclick="history.back()">Back</button>
	{% else %}
		<form id="RecipeForm" method="post" action="{% url 'pantry:add_recipe_method' %}" enctype="multipart/form-data">
			{% csrf_token %}
			
			<div class="general-info-area">
				{% for field in recipe_form.visible_fields %}
					{% if field != recipe_form.steps %}
						{{ field.help_text }}
						{{ field }}
						<span class="error-message">{{ field.errors|get_item:0 }}</span>
					{% endif %}
					<br/>
				{% endfor %}
				{% if ing_count >= 10 %}
					<p class="instruction">Enter the method for your recipe:</p>
					{{ recipe_form.steps }}
					<span class="error-message">{{ recipe_form.steps.errors|get_item:0 }}</span>
					<br />
					<i class="instruction">Hint: Press Enter whenever you move to a new step, but please don't number them!</i>
					<br />
				{% endif %}
			</div>
			
			<div class="main-info-area">
				{% if ingredients %}
				<p class="instruction">Enter the quantity for each ingredient, and whether it should be displayed in plural:</p>
				<div class="ingredient-info">
					{% for ingredient in ingredients %}
					<div id="column1">
						<label for="{{ ingredient }}">{{ ingredient }}:</label>
					</div>
					<div id="column2">
						<input class="short-info" type="text" id="{{ ingredient.name }}-quantity" name="{{ ingredient.name }}-quantity"/>
					</div>
					<div id="column3">
						<label for="{{ ingredient }}">&nbsp; Plural?</label>
						<input type="hidden" name="plural" value="False"/>
						<input class="checkbox" type="checkbox" id="{{ ingredient.name }}-plural" name="{{ ingredient.name }}-plural" />
					</div>
					{% endfor %}
				</div>
				<i class="hint">Hint: You can enter numbers, measuring units, or other words! Just make sure to keep it short.</i>
				<br /><br />
				{% endif %}
				
				{% if ing_count < 10 %}
					<p class="instruction">Enter the method for your recipe:</p>
					{{ recipe_form.steps }}
					<span class="error-message">{{ recipe_form.steps.errors|get_item:0 }}<span />
					<i class="hint">Hint: Press Enter whenever you move to a new step, but please don't number them!</i>
					<br />
				{% endif %}
			</div>
			
			<button class="btn-back" id="bottom-left" type="button" onclick="history.back()">Back</button>
			<input class="btn-continue" id="ingr-btn" type="submit" value="Submit">
		</form>
	{% endif %}
{% endblock %}