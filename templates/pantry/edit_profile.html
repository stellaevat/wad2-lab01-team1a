{% extends 'pantry/base.html' %}
{% load staticfiles %}
{% load pantry_template_tags %}

{% block title_block %}
	Edit Profile
{% endblock %}

{% block body_block %}
{% if img_form %}
	<span class="prompt">Profile picture: </span><br/>
	<form class="cat-header" id="form-edit-img" method="post" action="{% url 'pantry:edit_profile' user.username %}" enctype="multipart/form-data">
		{% csrf_token %}
		
		{% if user|get_profile_picture %}
			<img class="profile-picture-big" src="/media/{{ user|get_profile_picture }}" alt="User {{ user.username }}">
		{% else %}
			<img class="profile-picture-big" src="{% static 'img/profile-picture-default.png' %}" alt="User {{ user.username }}">
		{% endif %}
		
		<div>
			<input class="checkbox" type="checkbox" name="profile_picture-clear" id="profile_picture-clear_id">
			<label for="profile_picture-clear_id">Clear</label><br>
		or<br />
		Change:	<input type="file" name="profile_picture" accept="image/*" id="id_profile_picture"><br />
		
		{% if img_error %}
			<span class="error-message">{{ img_error }}<span><br />
		{% elif img_success %}
			<span class="success-message">{{ img_success }}<span><br />
		{% endif %}
		
		<input class="btn-continue" type="submit" name="img-submit" value="Update" />
		</div>
	</form>
	<div class="edit-profile-area">
		<form id="form-edit-username" method="post" action="{% url 'pantry:edit_profile' user.username %}" enctype="multipart/form-data">
			{% csrf_token %}
			<div class="change-field">
				<span class="prompt">Username: </span>
				<span class="field">{{ username_form.username }}</span>
			</div><br />
			
			{% if username_error %}
				<span class="error-message">{{ username_error }}</span><br />
				<input class="btn-continue" type="submit" name="username-submit" value="Try again" />
			{% elif username_success %}
				<span class="success-message">{{ username_success }}<span><br />
				<input class="btn-continue" type="submit" name="username-submit" value="Update" />
			{% else %}
				<input class="btn-continue" type="submit" name="username-submit" value="Update" />
			{% endif %}
		
			
			
		</form>
		<div class="gap-small"></div>
		
		<form id="form-edit-email" method="post" action="{% url 'pantry:edit_profile' user.username %}" enctype="multipart/form-data">
			{% csrf_token %}
			<div class="change-field">
				<span class="prompt">Email: </span>
				<span class="field">{{ email_form.email }}</span>
			</div><br />
			
			{% if email_error %}
				<span class="error-message">{{ email_error }}</span><br />
			{% elif email_success %}
				<span class="success-message">{{ email_success }}<span><br />
			{% endif %}
			
			<input class="btn-continue" type="submit" name="email-submit" value="Update" />
		</form>
		<div class="gap-small"></div>
		
		<form id="form-edit-password" method="post" action="{% url 'pantry:edit_profile' user.username %}" enctype="multipart/form-data">
			{% csrf_token %}
			
			<div class="change-field">
				<span class="prompt">Old password: </span>
				<span class="field">{{ pass_form.old_password }}</span><br />
			</div>
			<div class="change-field">
				<span class="prompt">New password: </span>
				<span class="field">{{ pass_form.new_password1 }}</span><br />
			</div>
			<div class="change-field">
				<span class="prompt">Confirm new password: </span>
				<span class="field">{{ pass_form.new_password2 }}</span>
			</div><br />
			
			{% if pass_error %}
				<span class="error-message">{{ pass_error }}</span><br/>
			{% elif pass_success %}
				<span class="success-message">{{ pass_success }}<span><br />
			{% endif %}
			
			<input class="btn-continue" type="submit" name="pass-submit" value="Update" />
			<br />
			
		</form>
		
		<div class="gap-small"></div>
		<form method="post" action = "{% url 'pantry:user_profile' user.username %}">
			{% csrf_token %}
			<button class="btn-back" type="submit">Done</button>
		</form>
	</div>
{% else %}
	<h1 class="central-heading">Invalid user</h1>
	<p class="info-message">Make sure you have the right spelling, and that you're signed in to the correct account!</p>
{% endif %}

{% endblock %}